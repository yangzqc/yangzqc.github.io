import{_ as A,r as o,g as B,h as F,i as v,j as M,c as l,o as i,k as I,a as n,v as k,F as f,b as y,t as T,n as D}from"./app-Bh8lMGBr.js";const j={class:"masonry-container"},q={class:"loading-container"},N={class:"error-overlay"},R={class:"error-list"},U={class:"masonry-grid"},V=["src","alt"],$=15,G=260,H={__name:"ImageMasonry",props:{images:{type:Array,default:()=>[]}},setup(C){const E=C;function b(e,t){let s;return function(...m){const h=()=>{clearTimeout(s),e(...m)};clearTimeout(s),s=setTimeout(h,t)}}const a=o(4),p=o(G),x=o(v?window.innerWidth:1200),u=o(!0),c=o([]),d=o(0),g=o(E.images),_=()=>{if(!v)return;const e=window.innerWidth;x.value=e,e>=1200?a.value=4:e>=900?a.value=3:e>=600?a.value=2:a.value=1;const t=e;p.value=(t-(a.value-1)*$)/a.value},L=B(()=>{const e=Array.from({length:a.value},()=>[]);return g.value.forEach((t,s)=>{const r=s%a.value;e[r].push(t)}),e}),W=e=>{const t=e.target;t.style.width="100%",t.style.height="auto",d.value++,d.value===g.value.length&&(u.value=!1)},S=e=>{const t=e.target;c.value.includes(t.alt)||c.value.push(t.alt),d.value++,d.value===g.value.length&&(u.value=!1)},z=()=>{const e=document.querySelectorAll(".masonry-item img");let t=0;e.forEach(s=>{s.complete&&(t++,s.style.width="100%",s.style.height="auto")}),t===e.length&&e.length>0&&(u.value=!1)},w=b(()=>{_()},200);return F(()=>{_(),v&&(window.addEventListener("resize",w),z())}),M(()=>{v&&window.removeEventListener("resize",w)}),(e,t)=>(i(),l("div",j,[I(n("div",q,t[0]||(t[0]=[n("div",{class:"loading-mask"},null,-1),n("div",{class:"loading-spinner"},"正在加载中，请稍等...",-1)]),512),[[k,u.value]]),I(n("div",N,[t[1]||(t[1]=n("div",{class:"error-title"},"以下图片加载失败：",-1)),n("ul",R,[(i(!0),l(f,null,y(c.value,(s,r)=>(i(),l("li",{key:r},T(s),1))),128))])],512),[[k,c.value.length]]),n("div",U,[(i(!0),l(f,null,y(L.value,(s,r)=>(i(),l("div",{key:r,class:"masonry-column",style:D({width:`${p.value}px`})},[(i(!0),l(f,null,y(s,(m,h)=>(i(),l("div",{key:h,class:"masonry-item"},[n("img",{src:m.imageSrc,alt:m.imageAlt,onLoad:W,onError:S},null,40,V)]))),128))],4))),128))])]))}},K=A(H,[["__scopeId","data-v-140b785b"]]);export{K as I};
