import{_ as z,r as n,d as A,e as B,f as M,i as v,g as F,c as o,o as l,w as I,a as r,v as E,F as f,b as y,t as T,n as D}from"./app-BYLAa8ZB.js";const q={class:"masonry-container"},N={class:"loading-container"},R={class:"error-overlay"},U={class:"error-list"},V={class:"masonry-grid"},$=["src","alt"],j=15,G=260,H={__name:"ImageMasonry",props:{images:{type:Array,default:()=>[]}},setup(x){const C=x;function L(e,t){let s;return function(...m){const h=()=>{clearTimeout(s),e(...m)};clearTimeout(s),s=setTimeout(h,t)}}const a=n(4),p=n(G),W=n(v?window.innerWidth:1200),u=n(!0),c=n([]),d=n(0),g=n(C.images),_=()=>{if(!v)return;const e=window.innerWidth;W.value=e,e>=1200?a.value=4:e>=900?a.value=3:e>=600?a.value=2:a.value=1;const t=e;p.value=(t-(a.value-1)*j)/a.value},k=A(()=>{const e=Array.from({length:a.value},()=>[]);return g.value.forEach((t,s)=>{const i=s%a.value;e[i].push(t)}),e}),S=e=>{const t=e.target;t.style.width="100%",t.style.height="auto",d.value++,d.value===g.value.length&&(u.value=!1)},b=e=>{const t=e.target;c.value.includes(t.alt)||c.value.push(t.alt),d.value++,d.value===g.value.length&&(u.value=!1)},w=L(()=>{_()},200);return B(()=>{_()}),M(()=>{if(v){window.addEventListener("resize",w);const e=document.querySelectorAll(".masonry-item img");let t=0;e.forEach(s=>{s.complete&&(t++,s.style.width="100%",s.style.height="auto")}),t===e.length&&e.length>0&&(u.value=!1)}}),F(()=>{v&&window.removeEventListener("resize",w)}),(e,t)=>(l(),o("div",q,[I(r("div",N,t[0]||(t[0]=[r("div",{class:"loading-spinner"},"正在加载中，请稍等...",-1)]),512),[[E,u.value]]),I(r("div",R,[t[1]||(t[1]=r("div",{class:"error-title"},"以下图片加载失败：",-1)),r("ul",U,[(l(!0),o(f,null,y(c.value,(s,i)=>(l(),o("li",{key:i},T(s),1))),128))])],512),[[E,c.value.length]]),r("div",V,[(l(!0),o(f,null,y(k.value,(s,i)=>(l(),o("div",{key:i,class:"masonry-column",style:D({width:`${p.value}px`})},[(l(!0),o(f,null,y(s,(m,h)=>(l(),o("div",{key:h,class:"masonry-item"},[r("img",{src:m.imageSrc,alt:m.imageAlt,onLoad:S,onError:b},null,40,$)]))),128))],4))),128))])]))}},K=z(H,[["__scopeId","data-v-646c0fc0"]]);export{K as I};
