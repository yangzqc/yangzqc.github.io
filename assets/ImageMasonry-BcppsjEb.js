import{_ as A,r as n,g as B,h as F,i as v,j as M,c as o,o as l,k as I,a as r,v as C,F as f,b as y,t as T,n as D}from"./app-IRo4iBA3.js";const j={class:"masonry-container"},q={class:"loading-container"},N={class:"error-overlay"},R={class:"error-list"},U={class:"masonry-grid"},V=["src","alt"],$=15,G=260,H={__name:"ImageMasonry",props:{images:{type:Array,default:()=>[]}},setup(E){const k=E;function x(e,t){let s;return function(...m){const g=()=>{clearTimeout(s),e(...m)};clearTimeout(s),s=setTimeout(g,t)}}const a=n(4),p=n(G),L=n(v?window.innerWidth:1200),u=n(!0),c=n([]),d=n(0),h=n(k.images),_=()=>{if(!v)return;const e=window.innerWidth;L.value=e,e>=1200?a.value=4:e>=900?a.value=3:e>=600?a.value=2:a.value=1;const t=e;p.value=(t-(a.value-1)*$)/a.value},W=B(()=>{const e=Array.from({length:a.value},()=>[]);return h.value.forEach((t,s)=>{const i=s%a.value;e[i].push(t)}),e}),b=e=>{const t=e.target;t.style.width="100%",t.style.height="auto",d.value++,d.value===h.value.length&&(u.value=!1)},S=e=>{const t=e.target;c.value.includes(t.alt)||c.value.push(t.alt),d.value++,d.value===h.value.length&&(u.value=!1)},z=()=>{const e=document.querySelectorAll(".masonry-item img");let t=0;e.forEach(s=>{s.complete&&(t++,s.style.width="100%",s.style.height="auto")}),t===e.length&&e.length>0&&(u.value=!1)},w=x(()=>{_()},200);return F(()=>{_(),v&&(window.addEventListener("resize",w),z())}),M(()=>{v&&window.removeEventListener("resize",w)}),(e,t)=>(l(),o("div",j,[I(r("div",q,t[0]||(t[0]=[r("div",{class:"loading-spinner"},"正在加载中，请稍等...",-1)]),512),[[C,u.value]]),I(r("div",N,[t[1]||(t[1]=r("div",{class:"error-title"},"以下图片加载失败：",-1)),r("ul",R,[(l(!0),o(f,null,y(c.value,(s,i)=>(l(),o("li",{key:i},T(s),1))),128))])],512),[[C,c.value.length]]),r("div",U,[(l(!0),o(f,null,y(W.value,(s,i)=>(l(),o("div",{key:i,class:"masonry-column",style:D({width:`${p.value}px`})},[(l(!0),o(f,null,y(s,(m,g)=>(l(),o("div",{key:g,class:"masonry-item"},[r("img",{src:m.imageSrc,alt:m.imageAlt,onLoad:b,onError:S},null,40,V)]))),128))],4))),128))])]))}},K=A(H,[["__scopeId","data-v-dbd2c8ef"]]);export{K as I};
